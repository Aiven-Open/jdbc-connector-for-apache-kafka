merge into "Book" with (HOLDLOCK) AS target using (select ? AS "author", ? AS "title", ? AS "ISBN", ? AS "year", ? AS "pages") AS incoming on (target."author"=incoming."author" and target."title"=incoming."title") when matched then update set "ISBN"=incoming."ISBN","year"=incoming."year","pages"=incoming."pages" when not matched then insert ("ISBN", "year", "pages", "author", "title") values (incoming."ISBN",incoming."year",incoming."pages",incoming."author",incoming."title");